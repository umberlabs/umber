#!/bin/bash
# UM Utility 1.3.2

echo "UM: Loaded main script. Starting..."

function err_exit() {
    echo "Installation failed. Please try again."
    exit 1
}
trap "err_exit" ERR

export DEBIAN_FRONTEND=noninteractive

read -r -p "UM: Install Homebrew? [Y/n] " hb
case $hb in
    [yY][eE][sS]|[yY])
        echo "UM: Installing Homebrew..."
        /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    ;;
    [nN][oO]|[nN]|'')
        echo "UM: Skipping..."
    ;;
esac

read -r -p "UM: Install Clean My Mac X (requires Homebrew)? [Y/n] " cm
case $cm in
    [yY][eE][sS]|[yY])
        echo "UM: Trying to start UM-hb..."
        echo "UM: Started UM-hb! Transferring packets..."
        echo "UM-hb: Triggering brew update & xcrun..."
        brew update
        echo "UM-hb: Installing formulae cleanmymac..."
        brew install --cask cleanmymac
        echo "UM: Done, stopping service UM-hb..."
    ;;
    [nN][oO]|[nN]|'')
        echo "UM: Skipping..."
    ;;
esac

read -r -p "UM: Install AppCleaner (requires Homebrew)? [Y/n] " ap
case $ap in
    [yY][eE][sS]|[yY])
        echo "UM: Trying to start UM-hb..."
        echo "UM: Started UM-hb! Transferring packets..."
        echo "UM-hb: Triggering brew update & xcrun..."
        brew update
        echo "UM-hb: Installing formulae app-cleaner..."
        brew install --cask app-cleaner
        echo "UM: Done, stopping service UM-hb..."
    ;;
    [nN][oO]|[nN]|'')
        echo "UM: Skipping..."
    ;;
esac

read -r -p "UM: Install Microsoft Edge (requires Homebrew)? [Y/n] " me
case $me in
    [yY][eE][sS]|[yY])
        echo "UM: Starting UM-hb agent..."
        echo "UM-hb: Started agent! Installing..."
        brew install --cask microsoft-edge
        echo "UM: Closing UM-hb agent..."
        echo "UM Closed UM-hb agent!"
        echo "UM: Cleaning up..."
    ;;
    [nN][oO]|[nN]|'')
        echo "UM: Skipping..."
    ;;
esac

read -r -p "UM: Install Homebrew Cask? [Y/n] " hbc
case $hbc in
    [yY][eE][sS]|[yY])
        echo "UM: Installing Homebrew Cask..."
        brew install cask
    ;;
    [nN][oO]|[nN]|'')
        echo "UM: Skipping..."
    ;;
esac

read -r -p "UM: Install Microsoft Powershell (Requires Homebrew, Cask)? [Y/n] " mp
case $mp in
    [yY][eE][sS]|[yY])
        echo "UM: Installing Microsoft Powershell..."
        brew install --cask powershell
    ;;
    [nN][oO]|[nN]|'')
        echo "UM: Skipping..."
    ;;
esac

read -r -p "UM: Install ClamAV (Requires Homebrew)? [Y/n] " ca
case $ca in
    [yY][eE][sS]|[yY])
        echo "UM: Installing ClamAV..."
        brew install clamav
    ;;
    [nN][oO]|[nN]|'')
        echo "UM: Skipping..."
    ;;
esac

read -r -p "UM: Install Starboard X? [Y/n] " sx
case $sx in
    [yY][eE][sS]|[yY])
        echo "UM: Installing Starboard X..."
        curl -o sx.zip https://github.com/js3r2/umber-insider/raw/inst-files/sx.zip
        unzip -b sx.zip
        mv Starboard\ X.app /Applications
    ;;
    [nN][oO]|[nN]|'')
        echo "UM: Skipping..."
    ;;
esac

read -r -p "UM: Install wget? [Y/n] " wg
case $wg in
    [yY][eE][sS]|[yY])
        echo "UM: Installing wget..."
        brew install wget
    ;;
    [nN][oO]|[nN]|'')
        echo "UM: Skipping..."
    ;;
esac

read -r -p "UM: Install Node.js (requires Homebrew)? [Y/n] " nj
case $nj in
    [yY][eE][sS]|[yY])
        echo "UM: Installing Node.js..."
        brew install node
    ;;
    [nN][oO]|[nN]|'')
        echo "UM: Skipping..."
    ;;
esac

echo "UM has finished! Enjoy your new software!"
